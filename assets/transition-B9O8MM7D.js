import{r,e as f}from"./index-yDOeu_rT.js";import{n as H,O as he,K as V,y as _,A as S,l as ee,o as E,x as ve,m as me,t as pe,R as be,i as y,L as ne,c as ge,u as re,s as Te,p as Ce,a as te}from"./use-server-handoff-complete-Vd7s5Y0y.js";function Ee(){let e=r.useRef(!1);return H(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function le(e){var n;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||((n=e.as)!=null?n:ue)!==r.Fragment||f.Children.count(e.children)===1}let z=r.createContext(null);z.displayName="TransitionContext";var we=(e=>(e.Visible="visible",e.Hidden="hidden",e))(we||{});function Re(){let e=r.useContext(z);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function Fe(){let e=r.useContext(D);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let D=r.createContext(null);D.displayName="NestingContext";function I(e){return"children"in e?I(e.children):e.current.filter(({el:n})=>n.current!==null).filter(({state:n})=>n==="visible").length>0}function ie(e,n){let l=Te(e),a=r.useRef([]),w=Ee(),x=Ce(),h=E((u,t=S.Hidden)=>{let s=a.current.findIndex(({el:i})=>i===u);s!==-1&&(te(t,{[S.Unmount](){a.current.splice(s,1)},[S.Hidden](){a.current[s].state="hidden"}}),x.microTask(()=>{var i;!I(a)&&w.current&&((i=l.current)==null||i.call(l))}))}),R=E(u=>{let t=a.current.find(({el:s})=>s===u);return t?t.state!=="visible"&&(t.state="visible"):a.current.push({el:u,state:"visible"}),()=>h(u,S.Unmount)}),p=r.useRef([]),d=r.useRef(Promise.resolve()),v=r.useRef({enter:[],leave:[]}),b=E((u,t,s)=>{p.current.splice(0),n&&(n.chains.current[t]=n.chains.current[t].filter(([i])=>i!==u)),n==null||n.chains.current[t].push([u,new Promise(i=>{p.current.push(i)})]),n==null||n.chains.current[t].push([u,new Promise(i=>{Promise.all(v.current[t].map(([F,L])=>L)).then(()=>i())})]),t==="enter"?d.current=d.current.then(()=>n==null?void 0:n.wait.current).then(()=>s(t)):s(t)}),g=E((u,t,s)=>{Promise.all(v.current[t].splice(0).map(([i,F])=>F)).then(()=>{var i;(i=p.current.shift())==null||i()}).then(()=>s(t))});return r.useMemo(()=>({children:a,register:R,unregister:h,onStart:b,onStop:g,wait:d,chains:v}),[R,h,a,b,g,v,d])}let ue=r.Fragment,se=he.RenderStrategy;function Pe(e,n){var l,a;let{transition:w=!0,beforeEnter:x,afterEnter:h,beforeLeave:R,afterLeave:p,enter:d,enterFrom:v,enterTo:b,entered:g,leave:u,leaveFrom:t,leaveTo:s,...i}=e,[F,L]=r.useState(null),o=r.useRef(null),T=le(e),P=_(...T?[o,n,L]:n===null?[]:[n]),W=(l=i.unmount)==null||l?S.Unmount:S.Hidden,{show:m,appear:X,initial:Y}=Re(),[C,K]=r.useState(m?"visible":"hidden"),Z=Fe(),{register:N,unregister:M}=Z;H(()=>N(o),[N,o]),H(()=>{if(W===S.Hidden&&o.current){if(m&&C!=="visible"){K("visible");return}return te(C,{hidden:()=>M(o),visible:()=>N(o)})}},[C,o,N,M,m,W]);let k=ee();H(()=>{if(T&&k&&C==="visible"&&o.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[o,C,k,T]);let oe=Y&&!X,$=X&&m&&Y,B=r.useRef(!1),U=ie(()=>{B.current||(K("hidden"),M(o))},Z),q=E(G=>{B.current=!0;let j=G?"enter":"leave";U.onStart(o,j,A=>{A==="enter"?x==null||x():A==="leave"&&(R==null||R())})}),J=E(G=>{let j=G?"enter":"leave";B.current=!1,U.onStop(o,j,A=>{A==="enter"?h==null||h():A==="leave"&&(p==null||p())}),j==="leave"&&!I(U)&&(K("hidden"),M(o))});r.useEffect(()=>{T&&w||(q(m),J(m))},[m,T,w]);let ce=!(!w||!T||!k||oe),[,c]=ve(ce,F,m,{start:q,end:J}),de=me({ref:P,className:((a=pe(i.className,$&&d,$&&v,c.enter&&d,c.enter&&c.closed&&v,c.enter&&!c.closed&&b,c.leave&&u,c.leave&&!c.closed&&t,c.leave&&c.closed&&s,!c.transition&&m&&g))==null?void 0:a.trim())||void 0,...be(c)}),O=0;C==="visible"&&(O|=y.Open),C==="hidden"&&(O|=y.Closed),c.enter&&(O|=y.Opening),c.leave&&(O|=y.Closing);let fe=ne();return f.createElement(D.Provider,{value:U},f.createElement(ge,{value:O},fe({ourProps:de,theirProps:i,defaultTag:ue,features:se,visible:C==="visible",name:"Transition.Child"})))}function Se(e,n){let{show:l,appear:a=!1,unmount:w=!0,...x}=e,h=r.useRef(null),R=le(e),p=_(...R?[h,n]:n===null?[]:[n]);ee();let d=re();if(l===void 0&&d!==null&&(l=(d&y.Open)===y.Open),l===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[v,b]=r.useState(l?"visible":"hidden"),g=ie(()=>{l||b("hidden")}),[u,t]=r.useState(!0),s=r.useRef([l]);H(()=>{u!==!1&&s.current[s.current.length-1]!==l&&(s.current.push(l),t(!1))},[s,l]);let i=r.useMemo(()=>({show:l,appear:a,initial:u}),[l,a,u]);H(()=>{l?b("visible"):!I(g)&&h.current!==null&&b("hidden")},[l,g]);let F={unmount:w},L=E(()=>{var P;u&&t(!1),(P=e.beforeEnter)==null||P.call(e)}),o=E(()=>{var P;u&&t(!1),(P=e.beforeLeave)==null||P.call(e)}),T=ne();return f.createElement(D.Provider,{value:g},f.createElement(z.Provider,{value:i},T({ourProps:{...F,as:r.Fragment,children:f.createElement(ae,{ref:p,...F,...x,beforeEnter:L,beforeLeave:o})},theirProps:{},defaultTag:r.Fragment,features:se,visible:v==="visible",name:"Transition"})))}function xe(e,n){let l=r.useContext(z)!==null,a=re()!==null;return f.createElement(f.Fragment,null,!l&&a?f.createElement(Q,{ref:n,...e}):f.createElement(ae,{ref:n,...e}))}let Q=V(Se),ae=V(Pe),ye=V(xe),Oe=Object.assign(Q,{Child:ye,Root:Q});export{ye as F,Ee as f,Oe as z};
