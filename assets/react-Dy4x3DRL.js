var B=Object.defineProperty;var O=e=>{throw TypeError(e)};var F=(e,o,t)=>o in e?B(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var S=(e,o,t)=>F(e,typeof o!="symbol"?o+"":o,t),M=(e,o,t)=>o.has(e)||O("Cannot "+t);var m=(e,o,t)=>(M(e,o,"read from private field"),t?t.call(e):o.get(e)),L=(e,o,t)=>o.has(e)?O("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(e):o.set(e,t),w=(e,o,t,u)=>(M(e,o,"write to private field"),u?u.call(e,t):o.set(e,t),t),I=(e,o,t)=>(M(e,o,"access private method"),t);import{e as $}from"./index-OlNebYNa.js";import{M as j,C as z}from"./mixin-C_e69MQf.js";import{H as p}from"./hls-BGvSEJpu.js";import"./_commonjsHelpers-CqkleIqs.js";import"./index-yBjzXJbu.js";const G=e=>{var o,t,u,E,x,g,H;return o=class extends e{constructor(){super();L(this,E);L(this,t,null);L(this,u,null);L(this,g,()=>{var a,l,f;(a=this.nativeEl)!=null&&a.webkitCurrentPlaybackTargetIsWireless?(l=this.api)==null||l.stopLoad():(f=this.api)==null||f.startLoad()});I(this,E,H).call(this,"config")}get config(){return m(this,u)}set config(a){w(this,u,a)}attributeChangedCallback(a,l,f){a!=="src"&&super.attributeChangedCallback(a,l,f),a==="src"&&l!=f&&this.load()}async load(){var a,l;const f=!this.api;if(I(this,E,x).call(this),!!this.src){if(f&&!m(this,u)&&w(this,u,JSON.parse(((a=this.shadowRoot.getElementById("config"))==null?void 0:a.textContent)||"{}")),p.isSupported()){switch(await Promise.resolve(),this.api=new p({liveDurationInfinity:!0,autoStartLoad:!1,...this.config}),this.api.loadSource(this.src),this.api.attachMedia(this.nativeEl),this.nativeEl.preload){case"none":{const d=()=>this.api.startLoad();this.nativeEl.addEventListener("play",d,{once:!0}),this.api.on(p.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",d)});break}case"metadata":{const d=this.api.config.maxBufferLength,s=this.api.config.maxBufferSize;this.api.config.maxBufferLength=1,this.api.config.maxBufferSize=1;const r=()=>{this.api.config.maxBufferLength=d,this.api.config.maxBufferSize=s};this.nativeEl.addEventListener("play",r,{once:!0}),this.api.on(p.Events.DESTROYING,()=>{this.nativeEl.removeEventListener("play",r)}),this.api.startLoad();break}default:this.api.startLoad()}this.nativeEl.webkitCurrentPlaybackTargetIsWireless&&this.api.stopLoad(),this.nativeEl.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",m(this,g)),w(this,t,document.createElement("source")),m(this,t).setAttribute("type","application/x-mpegURL"),m(this,t).setAttribute("src",this.src),this.nativeEl.disableRemotePlayback=!1,this.nativeEl.append(m(this,t));const T=new WeakMap;this.api.on(p.Events.MANIFEST_PARSED,(d,s)=>{this.nativeEl.autoplay&&this.nativeEl.paused&&this.nativeEl.play().catch(n=>{console.warn("Autoplay failed:",n)}),k();let r=this.videoTracks.getTrackById("main");r||(r=this.addVideoTrack("main"),r.id="main",r.selected=!0);for(const[n,i]of s.levels.entries()){const c=r.addRendition(i.url[0],i.width,i.height,i.videoCodec,i.bitrate);T.set(i,`${n}`),c.id=`${n}`}for(let[n,i]of s.audioTracks.entries()){const c=i.default?"main":"alternative",v=this.addAudioTrack(c,i.name,i.lang);v.id=`${n}`,i.default&&(v.enabled=!0)}}),this.audioTracks.addEventListener("change",()=>{var d;const s=+((d=[...this.audioTracks].find(n=>n.enabled))==null?void 0:d.id),r=this.api.audioTracks.map(n=>n.id);s!=this.api.audioTrack&&r.includes(s)&&(this.api.audioTrack=s)}),this.api.on(p.Events.LEVELS_UPDATED,(d,s)=>{const r=this.videoTracks[this.videoTracks.selectedIndex??0];if(!r)return;const n=s.levels.map(i=>T.get(i));for(const i of this.videoRenditions)i.id&&!n.includes(i.id)&&r.removeRendition(i)});let h=null;this.api.on(p.Events.ERROR,(d,s)=>{s.type===p.ErrorTypes.NETWORK_ERROR&&s.details===p.ErrorDetails.FRAG_LOAD_ERROR&&(h=s.frag.level)}),this.api.on(p.Events.LEVEL_SWITCHED,(d,s)=>{const r=s.level;h!==null&&r<h&&(console.warn(`⚠️ hls.js downgraded quality from level ${h} to ${r} due to fragment load failure.`),this.videoRenditions.selectedIndex=r,h=null)});const b=d=>{const s=d.target.selectedIndex;s!=this.api.nextLevel&&(this.api.nextLevel=s)};(l=this.videoRenditions)==null||l.addEventListener("change",b);const k=()=>{for(const d of this.videoTracks)this.removeVideoTrack(d);for(const d of this.audioTracks)this.removeAudioTrack(d)};this.api.once(p.Events.DESTROYING,k);return}await Promise.resolve(),this.nativeEl.canPlayType("application/vnd.apple.mpegurl")&&(this.nativeEl.src=this.src)}}},t=new WeakMap,u=new WeakMap,E=new WeakSet,x=function(){var a,l;(a=m(this,t))==null||a.remove(),(l=this.nativeEl)==null||l.removeEventListener("webkitcurrentplaybacktargetiswirelesschanged",m(this,g)),this.api&&(this.api.detachMedia(),this.api.destroy(),this.api=null)},g=new WeakMap,H=function(a){if(Object.prototype.hasOwnProperty.call(this,a)){const l=this[a];delete this[a],this[a]=l}},S(o,"shadowRootOptions",{...e.shadowRootOptions}),S(o,"getTemplateHTML",(a,l={})=>{const{src:f,...T}=a;return`
        <script type="application/json" id="config">
          ${JSON.stringify(l.config||{})}
        <\/script>
        ${e.getTemplateHTML(T)}
      `}),o},N=G(j(z));globalThis.customElements&&!globalThis.customElements.get("hls-video")&&globalThis.customElements.define("hls-video",N);var V=N,Y=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),J={className:"class",htmlFor:"for"};function C(e){return e.toLowerCase()}function P(e){if(typeof e=="boolean")return e?"":void 0;if(typeof e!="function"&&!(typeof e=="object"&&e!==null))return e}function U({react:e,tagName:o,elementClass:t,events:u,displayName:E,defaultProps:D,toAttributeName:g=C,toAttributeValue:W=P}){const R=Number.parseInt(e.version)>=19,_=e.forwardRef((a,l)=>{var f,T;const h=e.useRef(null),b=e.useRef(new Map),k={},d={},s={},r={};for(const[n,i]of Object.entries(a)){if(Y.has(n)){s[n]=i;continue}const c=g(J[n]??n);if(t.prototype&&n in t.prototype&&!(n in(((f=globalThis.HTMLElement)==null?void 0:f.prototype)??{}))&&!((T=t.observedAttributes)!=null&&T.some(y=>y===c))){r[n]=i;continue}if(n.startsWith("on")){k[n]=i;continue}const v=W(i);if(c&&v!=null&&(d[c]=String(v),R||(s[c]=v)),c&&R){const y=P(i);v!==y?s[c]=v:s[c]=i}}if(typeof window<"u"){for(const n in k){const i=k[n],c=n.endsWith("Capture"),v=((u==null?void 0:u[n])??n.slice(2).toLowerCase()).slice(0,c?-7:void 0);e.useLayoutEffect(()=>{const y=h==null?void 0:h.current;if(!(!y||typeof i!="function"))return y.addEventListener(v,i,c),()=>{y.removeEventListener(v,i,c)}},[h==null?void 0:h.current,i])}e.useLayoutEffect(()=>{if(h.current===null)return;const n=new Map;for(const i in r)A(h.current,i,r[i]),b.current.delete(i),n.set(i,r[i]);for(const[i,c]of b.current)A(h.current,i,void 0);b.current=n})}if(typeof window>"u"&&(t!=null&&t.getTemplateHTML)&&(t!=null&&t.shadowRootOptions)){const{mode:n,delegatesFocus:i}=t.shadowRootOptions,c=e.createElement("template",{shadowrootmode:n,shadowrootdelegatesfocus:i,dangerouslySetInnerHTML:{__html:t.getTemplateHTML(d,a)},key:"ce-la-react-ssr-template-shadow-root"});s.children=[c,s.children]}return e.createElement(o,{...D,...s,ref:e.useCallback(n=>{h.current=n,typeof l=="function"?l(n):l!==null&&(l.current=n)},[l])},s.children)});return _.displayName=E??t.name,_}function A(e,o,t){var u;e[o]=t,t==null&&o in(((u=globalThis.HTMLElement)==null?void 0:u.prototype)??{})&&e.removeAttribute(o)}var ie=U({react:$,tagName:"hls-video",elementClass:V,toAttributeName(e){return e==="muted"?"":e==="defaultMuted"?"muted":C(e)}});/*! Bundled license information:

ce-la-react/dist/ce-la-react.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *
   * Modified version of `@lit/react` for vanilla custom elements with support for SSR.
   *)
*/export{ie as default};
