import{r,R as h}from"./index-BwDkhjyp.js";import{n as F,M as ce,W as D,y as Z,O as x,l as q,o as R,V as de,m as fe,t as ve,A as he,i as S,c as me,H as B,u as ee,a as pe,s as be,p as ge,b as ne}from"./use-server-handoff-complete-DpV5tE3Q.js";function Ee(){let e=r.useRef(!1);return F(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function re(e){var n;return!!(e.enter||e.enterFrom||e.enterTo||e.leave||e.leaveFrom||e.leaveTo)||((n=e.as)!=null?n:le)!==r.Fragment||h.Children.count(e.children)===1}let N=r.createContext(null);N.displayName="TransitionContext";var Te=(e=>(e.Visible="visible",e.Hidden="hidden",e))(Te||{});function $e(){let e=r.useContext(N);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}function Re(){let e=r.useContext(I);if(e===null)throw new Error("A <Transition.Child /> is used but it is missing a parent <Transition /> or <Transition.Root />.");return e}let I=r.createContext(null);I.displayName="NestingContext";function U(e){return"children"in e?U(e.children):e.current.filter(({el:n})=>n.current!==null).filter(({state:n})=>n==="visible").length>0}function te(e,n){let l=be(e),o=r.useRef([]),w=Ee(),P=ge(),d=R((a,t=x.Hidden)=>{let s=o.current.findIndex(({el:i})=>i===a);s!==-1&&(ne(t,{[x.Unmount](){o.current.splice(s,1)},[x.Hidden](){o.current[s].state="hidden"}}),P.microTask(()=>{var i;!U(o)&&w.current&&((i=l.current)==null||i.call(l))}))}),C=R(a=>{let t=o.current.find(({el:s})=>s===a);return t?t.state!=="visible"&&(t.state="visible"):o.current.push({el:a,state:"visible"}),()=>d(a,x.Unmount)}),g=r.useRef([]),f=r.useRef(Promise.resolve()),m=r.useRef({enter:[],leave:[]}),p=R((a,t,s)=>{g.current.splice(0),n&&(n.chains.current[t]=n.chains.current[t].filter(([i])=>i!==a)),n==null||n.chains.current[t].push([a,new Promise(i=>{g.current.push(i)})]),n==null||n.chains.current[t].push([a,new Promise(i=>{Promise.all(m.current[t].map(([u,v])=>v)).then(()=>i())})]),t==="enter"?f.current=f.current.then(()=>n==null?void 0:n.wait.current).then(()=>s(t)):s(t)}),E=R((a,t,s)=>{Promise.all(m.current[t].splice(0).map(([i,u])=>u)).then(()=>{var i;(i=g.current.shift())==null||i()}).then(()=>s(t))});return r.useMemo(()=>({children:o,register:C,unregister:d,onStart:p,onStop:E,wait:f,chains:m}),[C,d,o,p,E,m,f])}let le=r.Fragment,ie=ce.RenderStrategy;function we(e,n){var l,o;let{transition:w=!0,beforeEnter:P,afterEnter:d,beforeLeave:C,afterLeave:g,enter:f,enterFrom:m,enterTo:p,entered:E,leave:a,leaveFrom:t,leaveTo:s,...i}=e,u=r.useRef(null),v=re(e),V=Z(...v?[u,n]:n===null?[]:[n]),T=(l=i.unmount)==null||l?x.Unmount:x.Hidden,{show:b,appear:G,initial:J}=$e(),[$,X]=r.useState(b?"visible":"hidden"),K=Re(),{register:O,unregister:A}=K;F(()=>O(u),[O,u]),F(()=>{if(T===x.Hidden&&u.current){if(b&&$!=="visible"){X("visible");return}return ne($,{hidden:()=>A(u),visible:()=>O(u)})}},[$,u,O,A,b,T]);let j=q();F(()=>{if(v&&j&&$==="visible"&&u.current===null)throw new Error("Did you forget to passthrough the `ref` to the actual DOM node?")},[u,$,j,v]);let ae=J&&!G,Q=G&&b&&J,_=r.useRef(!1),L=te(()=>{_.current||(X("hidden"),A(u))},K),W=R(k=>{_.current=!0;let M=k?"enter":"leave";L.onStart(u,M,H=>{H==="enter"?P==null||P():H==="leave"&&(C==null||C())})}),Y=R(k=>{let M=k?"enter":"leave";_.current=!1,L.onStop(u,M,H=>{H==="enter"?d==null||d():H==="leave"&&(g==null||g())}),M==="leave"&&!U(L)&&(X("hidden"),A(u))});r.useEffect(()=>{v&&w||(W(b),Y(b))},[b,v,w]);let se=!(!w||!v||!j||ae),[,c]=de(se,u,b,{start:W,end:Y}),oe=fe({ref:V,className:((o=ve(i.className,Q&&f,Q&&m,c.enter&&f,c.enter&&c.closed&&m,c.enter&&!c.closed&&p,c.leave&&a,c.leave&&!c.closed&&t,c.leave&&c.closed&&s,!c.transition&&b&&E))==null?void 0:o.trim())||void 0,...he(c)}),y=0;return $==="visible"&&(y|=S.Open),$==="hidden"&&(y|=S.Closed),c.enter&&(y|=S.Opening),c.leave&&(y|=S.Closing),h.createElement(I.Provider,{value:L},h.createElement(me,{value:y},B({ourProps:oe,theirProps:i,defaultTag:le,features:ie,visible:$==="visible",name:"Transition.Child"})))}function Ce(e,n){let{show:l,appear:o=!1,unmount:w=!0,...P}=e,d=r.useRef(null),C=re(e),g=Z(...C?[d,n]:n===null?[]:[n]);q();let f=ee();if(l===void 0&&f!==null&&(l=(f&S.Open)===S.Open),l===void 0)throw new Error("A <Transition /> is used but it is missing a `show={true | false}` prop.");let[m,p]=r.useState(l?"visible":"hidden"),E=te(()=>{l||p("hidden")}),[a,t]=r.useState(!0),s=r.useRef([l]);F(()=>{a!==!1&&s.current[s.current.length-1]!==l&&(s.current.push(l),t(!1))},[s,l]);let i=r.useMemo(()=>({show:l,appear:o,initial:a}),[l,o,a]);pe(l,d,()=>p("hidden")),F(()=>{l?p("visible"):!U(E)&&d.current!==null&&p("hidden")},[l,E]);let u={unmount:w},v=R(()=>{var T;a&&t(!1),(T=e.beforeEnter)==null||T.call(e)}),V=R(()=>{var T;a&&t(!1),(T=e.beforeLeave)==null||T.call(e)});return h.createElement(I.Provider,{value:E},h.createElement(N.Provider,{value:i},B({ourProps:{...u,as:r.Fragment,children:h.createElement(ue,{ref:g,...u,...P,beforeEnter:v,beforeLeave:V})},theirProps:{},defaultTag:r.Fragment,features:ie,visible:m==="visible",name:"Transition"})))}function xe(e,n){let l=r.useContext(N)!==null,o=ee()!==null;return h.createElement(h.Fragment,null,!l&&o?h.createElement(z,{ref:n,...e}):h.createElement(ue,{ref:n,...e}))}let z=D(Ce),ue=D(we),Pe=D(xe),ye=Object.assign(z,{Child:Pe,Root:z});export{Pe as I,ye as X,Ee as f};
