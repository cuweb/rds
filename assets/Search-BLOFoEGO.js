import{j as C}from"./jsx-runtime-CKrituN3.js";import{r as f,R as N}from"./index-CBqU2yxZ.js";import{j as Pe}from"./optionClasses-nRtJeGr9.js";import{u as $e}from"./useLinkContext-Ch0lwH8X.js";import{m as ve,t as be,_ as ge}from"./dialog-BHhb4iix.js";import{r as _e}from"./index-BtM5VmRH.js";import{s as Se,l as L,o as x,O as xe,U as Z,u as J,p as de,a as De,d as ne,x as Ae,C as G,y as Y,b as je,c as Oe,q as ae}from"./transition-Dz28ezoH.js";import{y as Le,b as Ne,s as Ve,I as Q,n as Be,o as A,r as Ke,k as qe,j as Ue}from"./use-root-containers-CiCts8xM.js";import{T as Xe}from"./use-resolve-button-type-BHDntMkD.js";import{F as Je,u as Ze,c as E,f as ye}from"./calculate-active-index-CmL1XPTK.js";function Ge({title:t,titleId:r,...e},o){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":r},e),t?f.createElement("title",{id:r},t):null,f.createElement("path",{fillRule:"evenodd",d:"M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z",clipRule:"evenodd"}))}const He=f.forwardRef(Ge),Ie=He;function Ye({title:t,titleId:r,...e},o){return f.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":r},e),t?f.createElement("title",{id:r},t):null,f.createElement("path",{fillRule:"evenodd",d:"M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const Qe=f.forwardRef(Ye),We=Qe;function X(t,r,e){let o=e.initialDeps??[],n;return()=>{var i,l,u,d;let a;e.key&&((i=e.debug)!=null&&i.call(e))&&(a=Date.now());const p=t();if(!(p.length!==o.length||p.some((s,h)=>o[h]!==s)))return n;o=p;let v;if(e.key&&((l=e.debug)!=null&&l.call(e))&&(v=Date.now()),n=r(...p),e.key&&((u=e.debug)!=null&&u.call(e))){const s=Math.round((Date.now()-a)*100)/100,h=Math.round((Date.now()-v)*100)/100,I=h/16,O=(b,M)=>{for(b=String(b);b.length<M;)b=" "+b;return b};console.info(`%câ± ${O(h,5)} /${O(s,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*I,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(d=e==null?void 0:e.onChange)==null||d.call(e,n),n}}function ue(t,r){if(t===void 0)throw new Error(`Unexpected undefined${r?`: ${r}`:""}`);return t}const et=(t,r)=>Math.abs(t-r)<1,tt=t=>t,ot=t=>{const r=Math.max(t.startIndex-t.overscan,0),e=Math.min(t.endIndex+t.overscan,t.count-1),o=[];for(let n=r;n<=e;n++)o.push(n);return o},nt=(t,r)=>{const e=t.scrollElement;if(!e)return;const o=i=>{const{width:l,height:u}=i;r({width:Math.round(l),height:Math.round(u)})};if(o(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const n=new ResizeObserver(i=>{const l=i[0];if(l!=null&&l.borderBoxSize){const u=l.borderBoxSize[0];if(u){o({width:u.inlineSize,height:u.blockSize});return}}o(e.getBoundingClientRect())});return n.observe(e,{box:"border-box"}),()=>{n.unobserve(e)}},it=(t,r)=>{const e=t.scrollElement;if(!e)return;const o=()=>{r(e[t.options.horizontal?"scrollLeft":"scrollTop"])};return o(),e.addEventListener("scroll",o,{passive:!0}),()=>{e.removeEventListener("scroll",o)}},rt=(t,r,e)=>{if(r!=null&&r.borderBoxSize){const o=r.borderBoxSize[0];if(o)return Math.round(o[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(t.getBoundingClientRect()[e.options.horizontal?"width":"height"])},lt=(t,{adjustments:r=0,behavior:e},o)=>{var n,i;const l=t+r;(i=(n=o.scrollElement)==null?void 0:n.scrollTo)==null||i.call(n,{[o.options.horizontal?"left":"top"]:l,behavior:e})};class st{constructor(r){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const o=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(n=>{n.forEach(i=>{this._measureElement(i.target,i)})}):null);return{disconnect:()=>{var n;return(n=o())==null?void 0:n.disconnect()},observe:n=>{var i;return(i=o())==null?void 0:i.observe(n,{box:"border-box"})},unobserve:n=>{var i;return(i=o())==null?void 0:i.unobserve(n)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([o,n])=>{typeof n>"u"&&delete e[o]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:tt,rangeExtractor:ot,onChange:()=>{},measureElement:rt,initialRect:{width:0,height:0},scrollMargin:0,gap:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,...e}},this.notify=e=>{var o,n;(n=(o=this.options).onChange)==null||n.call(o,this,e)},this.maybeNotify=X(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,o=>{this.scrollRect=o,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,o=>{this.scrollAdjustments=0,this.scrollOffset!==o&&(this.isScrollingTimeoutId!==null&&(clearTimeout(this.isScrollingTimeoutId),this.isScrollingTimeoutId=null),this.isScrolling=!0,this.scrollDirection=this.scrollOffset<o?"forward":"backward",this.scrollOffset=o,this.maybeNotify(),this.isScrollingTimeoutId=setTimeout(()=>{this.isScrollingTimeoutId=null,this.isScrolling=!1,this.scrollDirection=null,this.maybeNotify()},this.options.scrollingDelay))})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.memoOptions=X(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,o,n,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:o,scrollMargin:n,getItemKey:i}),{key:!1}),this.getFurthestMeasurement=(e,o)=>{const n=new Map,i=new Map;for(let l=o-1;l>=0;l--){const u=e[l];if(n.has(u.lane))continue;const d=i.get(u.lane);if(d==null||u.end>d.end?i.set(u.lane,u):u.end<d.end&&n.set(u.lane,!0),n.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((l,u)=>l.end===u.end?l.index-u.index:l.end-u.end)[0]:void 0},this.getMeasurements=X(()=>[this.memoOptions(),this.itemSizeCache],({count:e,paddingStart:o,scrollMargin:n,getItemKey:i},l)=>{const u=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const d=this.measurementsCache.slice(0,u);for(let a=u;a<e;a++){const p=i(a),g=this.options.lanes===1?d[a-1]:this.getFurthestMeasurement(d,a),v=g?g.end+this.options.gap:o+n,s=l.get(p),h=typeof s=="number"?s:this.options.estimateSize(a),I=v+h,O=g?g.lane:a%this.options.lanes;d[a]={index:a,start:v,size:h,end:I,key:p,lane:O}}return this.measurementsCache=d,d},{key:!1,debug:()=>this.options.debug}),this.calculateRange=X(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,o,n)=>this.range=e.length>0&&o>0?at({measurements:e,outerSize:o,scrollOffset:n}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=X(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,o,n,i)=>o===null?[]:e({...o,overscan:n,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const o=this.options.indexAttribute,n=e.getAttribute(o);return n?parseInt(n,10):(console.warn(`Missing attribute name '${o}={index}' on measured element.`),-1)},this._measureElement=(e,o)=>{const n=this.measurementsCache[this.indexFromElement(e)];if(!n||!e.isConnected){this.measureElementCache.forEach((u,d)=>{u===e&&(this.observer.unobserve(e),this.measureElementCache.delete(d))});return}const i=this.measureElementCache.get(n.key);i!==e&&(i&&this.observer.unobserve(i),this.observer.observe(e),this.measureElementCache.set(n.key,e));const l=this.options.measureElement(e,o,this);this.resizeItem(n,l)},this.resizeItem=(e,o)=>{const n=this.itemSizeCache.get(e.key)??e.size,i=o-n;i!==0&&(e.start<this.scrollOffset+this.scrollAdjustments&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,o)),this.notify(!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=X(()=>[this.getIndexes(),this.getMeasurements()],(e,o)=>{const n=[];for(let i=0,l=e.length;i<l;i++){const u=e[i],d=o[u];n.push(d)}return n},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const o=this.getMeasurements();return ue(o[Re(0,o.length-1,n=>ue(o[n]).start,e)])},this.getOffsetForAlignment=(e,o)=>{const n=this.getSize();o==="auto"&&(e<=this.scrollOffset?o="start":e>=this.scrollOffset+n?o="end":o="start"),o==="start"?e=e:o==="end"?e=e-n:o==="center"&&(e=e-n/2);const i=this.options.horizontal?"scrollWidth":"scrollHeight",u=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-this.getSize();return Math.max(Math.min(u,e),0)},this.getOffsetForIndex=(e,o="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const n=ue(this.getMeasurements()[e]);if(o==="auto")if(n.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)o="end";else if(n.start<=this.scrollOffset+this.options.scrollPaddingStart)o="start";else return[this.scrollOffset,o];const i=o==="end"?n.end+this.options.scrollPaddingEnd:n.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(i,o),o]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:o="start",behavior:n}={})=>{this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,o),{adjustments:void 0,behavior:n})},this.scrollToIndex=(e,{align:o="auto",behavior:n}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),n==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[i,l]=this.getOffsetForIndex(e,o);this._scrollToOffset(i,{adjustments:void 0,behavior:n}),n!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[d]=this.getOffsetForIndex(e,l);et(d,this.scrollOffset)||this.scrollToIndex(e,{align:l,behavior:n})}else this.scrollToIndex(e,{align:l,behavior:n})}))},this.scrollBy=(e,{behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:o})},this.getTotalSize=()=>{var e;const o=this.getMeasurements();let n;return o.length===0?n=this.options.paddingStart:n=this.options.lanes===1?((e=o[o.length-1])==null?void 0:e.end)??0:Math.max(...o.slice(-this.options.lanes).map(i=>i.end)),n-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:o,behavior:n})=>{this.options.scrollToFn(e,{behavior:n,adjustments:o},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(r),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.maybeNotify()}}const Re=(t,r,e,o)=>{for(;t<=r;){const n=(t+r)/2|0,i=e(n);if(i<o)t=n+1;else if(i>o)r=n-1;else return n}return t>0?t-1:0};function at({measurements:t,outerSize:r,scrollOffset:e}){const o=t.length-1,i=Re(0,o,u=>t[u].start,e);let l=i;for(;l<o&&t[l].end<e+r;)l++;return{startIndex:i,endIndex:l}}const ut=typeof document<"u"?f.useLayoutEffect:f.useEffect;function ct(t){const r=f.useReducer(()=>({}),{})[1],e={...t,onChange:(n,i)=>{var l;i?_e.flushSync(r):r(),(l=t.onChange)==null||l.call(t,n,i)}},[o]=f.useState(()=>new st(e));return o.setOptions(e),f.useEffect(()=>o._didMount(),[]),ut(()=>o._willUpdate()),o}function dt(t){return ct({observeElementRect:nt,observeElementOffset:it,scrollToFn:lt,...t})}function fe(t,r){let[e,o]=f.useState(t),n=Se(t);return L(()=>o(n.current),[n,o,...r]),e}function ft(t,r,e){let[o,n]=f.useState(e),i=t!==void 0,l=f.useRef(i),u=f.useRef(!1),d=f.useRef(!1);return i&&!l.current&&!u.current?(u.current=!0,l.current=i,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!i&&l.current&&!d.current&&(d.current=!0,l.current=i,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[i?t:o,x(a=>(i||n(a),r==null?void 0:r(a)))]}function Ce(t={},r=null,e=[]){for(let[o,n]of Object.entries(t))Ee(e,Te(r,o),n);return e}function Te(t,r){return t?t+"["+r+"]":r}function Ee(t,r,e){if(Array.isArray(e))for(let[o,n]of e.entries())Ee(t,Te(r,o.toString()),n);else e instanceof Date?t.push([r,e.toISOString()]):typeof e=="boolean"?t.push([r,e?"1":"0"]):typeof e=="string"?t.push([r,e]):typeof e=="number"?t.push([r,`${e}`]):e==null?t.push([r,""]):Ce(e,r,t)}var pt={},ht=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(ht||{}),mt=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(mt||{}),vt=(t=>(t[t.Pointer=0]="Pointer",t[t.Focus=1]="Focus",t[t.Other=2]="Other",t))(vt||{}),bt=(t=>(t[t.OpenCombobox=0]="OpenCombobox",t[t.CloseCombobox=1]="CloseCombobox",t[t.GoToOption=2]="GoToOption",t[t.RegisterOption=3]="RegisterOption",t[t.UnregisterOption=4]="UnregisterOption",t[t.RegisterLabel=5]="RegisterLabel",t[t.SetActivationTrigger=6]="SetActivationTrigger",t[t.UpdateVirtualOptions=7]="UpdateVirtualOptions",t))(bt||{});function ce(t,r=e=>e){let e=t.activeOptionIndex!==null?t.options[t.activeOptionIndex]:null,o=r(t.options.slice()),n=o.length>0&&o[0].dataRef.current.order!==null?o.sort((l,u)=>l.dataRef.current.order-u.dataRef.current.order):Ue(o,l=>l.dataRef.current.domRef.current),i=e?n.indexOf(e):null;return i===-1&&(i=null),{options:n,activeOptionIndex:i}}let gt={1(t){var r;return(r=t.dataRef.current)!=null&&r.disabled||t.comboboxState===1?t:{...t,activeOptionIndex:null,comboboxState:1}},0(t){var r,e;if((r=t.dataRef.current)!=null&&r.disabled||t.comboboxState===0)return t;if((e=t.dataRef.current)!=null&&e.value){let o=t.dataRef.current.calculateIndex(t.dataRef.current.value);if(o!==-1)return{...t,activeOptionIndex:o,comboboxState:0}}return{...t,comboboxState:0}},2(t,r){var e,o,n,i,l;if((e=t.dataRef.current)!=null&&e.disabled||(o=t.dataRef.current)!=null&&o.optionsRef.current&&!((n=t.dataRef.current)!=null&&n.optionsPropsRef.current.static)&&t.comboboxState===1)return t;if(t.virtual){let p=r.focus===E.Specific?r.idx:ye(r,{resolveItems:()=>t.virtual.options,resolveActiveIndex:()=>{var v,s;return(s=(v=t.activeOptionIndex)!=null?v:t.virtual.options.findIndex(h=>!t.virtual.disabled(h)))!=null?s:null},resolveDisabled:t.virtual.disabled,resolveId(){throw new Error("Function not implemented.")}}),g=(i=r.trigger)!=null?i:2;return t.activeOptionIndex===p&&t.activationTrigger===g?t:{...t,activeOptionIndex:p,activationTrigger:g}}let u=ce(t);if(u.activeOptionIndex===null){let p=u.options.findIndex(g=>!g.dataRef.current.disabled);p!==-1&&(u.activeOptionIndex=p)}let d=r.focus===E.Specific?r.idx:ye(r,{resolveItems:()=>u.options,resolveActiveIndex:()=>u.activeOptionIndex,resolveId:p=>p.id,resolveDisabled:p=>p.dataRef.current.disabled}),a=(l=r.trigger)!=null?l:2;return t.activeOptionIndex===d&&t.activationTrigger===a?t:{...t,...u,activeOptionIndex:d,activationTrigger:a}},3:(t,r)=>{var e,o,n;if((e=t.dataRef.current)!=null&&e.virtual)return{...t,options:[...t.options,r.payload]};let i=r.payload,l=ce(t,d=>(d.push(i),d));t.activeOptionIndex===null&&(o=t.dataRef.current)!=null&&o.isSelected(r.payload.dataRef.current.value)&&(l.activeOptionIndex=l.options.indexOf(i));let u={...t,...l,activationTrigger:2};return(n=t.dataRef.current)!=null&&n.__demoMode&&t.dataRef.current.value===void 0&&(u.activeOptionIndex=0),u},4:(t,r)=>{var e;if((e=t.dataRef.current)!=null&&e.virtual)return{...t,options:t.options.filter(n=>n.id!==r.id)};let o=ce(t,n=>{let i=n.findIndex(l=>l.id===r.id);return i!==-1&&n.splice(i,1),n});return{...t,...o,activationTrigger:2}},5:(t,r)=>t.labelId===r.id?t:{...t,labelId:r.id},6:(t,r)=>t.activationTrigger===r.trigger?t:{...t,activationTrigger:r.trigger},7:(t,r)=>{var e;if(((e=t.virtual)==null?void 0:e.options)===r.options)return t;let o=t.activeOptionIndex;if(t.activeOptionIndex!==null){let n=r.options.indexOf(t.virtual.options[t.activeOptionIndex]);n!==-1?o=n:o=null}return{...t,activeOptionIndex:o,virtual:Object.assign({},t.virtual,{options:r.options})}}},pe=f.createContext(null);pe.displayName="ComboboxActionsContext";function W(t){let r=f.useContext(pe);if(r===null){let e=new Error(`<${t} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,W),e}return r}let we=f.createContext(null);function xt(t){var r;let e=B("VirtualProvider"),[o,n]=f.useMemo(()=>{let d=e.optionsRef.current;if(!d)return[0,0];let a=window.getComputedStyle(d);return[parseFloat(a.paddingBlockStart||a.paddingTop),parseFloat(a.paddingBlockEnd||a.paddingBottom)]},[e.optionsRef.current]),i=dt({scrollPaddingStart:o,scrollPaddingEnd:n,count:e.virtual.options.length,estimateSize(){return 40},getScrollElement(){var d;return(d=e.optionsRef.current)!=null?d:null},overscan:12}),[l,u]=f.useState(0);return L(()=>{u(d=>d+1)},[(r=e.virtual)==null?void 0:r.options]),N.createElement(we.Provider,{value:i},N.createElement("div",{style:{position:"relative",width:"100%",height:`${i.getTotalSize()}px`},ref:d=>{if(d){if(typeof process<"u"&&pt.JEST_WORKER_ID!==void 0||e.activationTrigger===0)return;e.activeOptionIndex!==null&&e.virtual.options.length>e.activeOptionIndex&&i.scrollToIndex(e.activeOptionIndex)}}},i.getVirtualItems().map(d=>{var a;return N.createElement(f.Fragment,{key:d.key},N.cloneElement((a=t.children)==null?void 0:a.call(t,{option:e.virtual.options[d.index],open:e.comboboxState===0}),{key:`${l}-${d.key}`,"data-index":d.index,"aria-setsize":e.virtual.options.length,"aria-posinset":d.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${d.start}px)`,overflowAnchor:"none"}}))})))}let he=f.createContext(null);he.displayName="ComboboxDataContext";function B(t){let r=f.useContext(he);if(r===null){let e=new Error(`<${t} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,B),e}return r}function Ot(t,r){return J(r.type,gt,t,r)}let yt=f.Fragment;function It(t,r){let{value:e,defaultValue:o,onChange:n,form:i,name:l,by:u=null,disabled:d=!1,__demoMode:a=!1,nullable:p=!1,multiple:g=!1,immediate:v=!1,virtual:s=null,...h}=t,I=!1,O=null,[b=g?[]:void 0,M]=ft(e,n,o),[k,F]=f.useReducer(Ot,{dataRef:f.createRef(),comboboxState:a?0:1,options:[],virtual:null,activeOptionIndex:null,activationTrigger:2,labelId:null}),P=f.useRef(!1),K=f.useRef({static:!1,hold:!1}),q=f.useRef(null),U=f.useRef(null),H=f.useRef(null),R=f.useRef(null),S=x(typeof u=="string"?(m,y)=>{let $=u;return(m==null?void 0:m[$])===(y==null?void 0:y[$])}:u??((m,y)=>m===y)),_=x(m=>k.options.findIndex(y=>S(y.dataRef.current.value,m))),ie=f.useCallback(m=>J(c.mode,{1:()=>b.some(y=>S(y,m)),0:()=>S(b,m)}),[b]),re=x(m=>k.activeOptionIndex===_(m)),c=f.useMemo(()=>({...k,immediate:I,optionsPropsRef:K,labelRef:q,inputRef:U,buttonRef:H,optionsRef:R,value:b,defaultValue:o,disabled:d,mode:g?1:0,virtual:k.virtual,get activeOptionIndex(){if(P.current&&k.activeOptionIndex===null&&k.options.length>0){let m=k.options.findIndex(y=>!y.dataRef.current.disabled);if(m!==-1)return m}return k.activeOptionIndex},calculateIndex:_,compare:S,isSelected:ie,isActive:re,nullable:p,__demoMode:a}),[b,o,d,g,p,a,k,O]);L(()=>{},[O,void 0]),L(()=>{k.dataRef.current=c},[c]),Le([c.buttonRef,c.inputRef,c.optionsRef],()=>se.closeCombobox(),c.comboboxState===0);let z=f.useMemo(()=>{var m,y,$;return{open:c.comboboxState===0,disabled:d,activeIndex:c.activeOptionIndex,activeOption:c.activeOptionIndex===null?null:c.virtual?c.virtual.options[(m=c.activeOptionIndex)!=null?m:0]:($=(y=c.options[c.activeOptionIndex])==null?void 0:y.dataRef.current.value)!=null?$:null,value:b}},[c,d,b]),w=x(()=>{if(c.activeOptionIndex!==null){if(c.virtual)le(c.virtual.options[c.activeOptionIndex]);else{let{dataRef:m}=c.options[c.activeOptionIndex];le(m.current.value)}se.goToOption(E.Specific,c.activeOptionIndex)}}),j=x(()=>{F({type:0}),P.current=!0}),T=x(()=>{F({type:1}),P.current=!1}),D=x((m,y,$)=>(P.current=!1,m===E.Specific?F({type:2,focus:E.Specific,idx:y,trigger:$}):F({type:2,focus:m,trigger:$}))),V=x((m,y)=>(F({type:3,payload:{id:m,dataRef:y}}),()=>{c.isActive(y.current.value)&&(P.current=!0),F({type:4,id:m})})),Me=x(m=>(F({type:5,id:m}),()=>F({type:5,id:null}))),le=x(m=>J(c.mode,{0(){return M==null?void 0:M(m)},1(){let y=c.value.slice(),$=y.findIndex(te=>S(te,m));return $===-1?y.push(m):y.splice($,1),M==null?void 0:M(y)}})),ke=x(m=>{F({type:6,trigger:m})}),se=f.useMemo(()=>({onChange:le,registerOption:V,registerLabel:Me,goToOption:D,closeCombobox:T,openCombobox:j,setActivationTrigger:ke,selectActiveOption:w}),[]),ze=r===null?{}:{ref:r},ee=f.useRef(null),Fe=de();return f.useEffect(()=>{ee.current&&o!==void 0&&Fe.addEventListener(ee.current,"reset",()=>{M==null||M(o)})},[ee,M]),N.createElement(pe.Provider,{value:se},N.createElement(he.Provider,{value:c},N.createElement(De,{value:J(c.comboboxState,{0:ne.Open,1:ne.Closed})},l!=null&&b!=null&&Ce({[l]:b}).map(([m,y],$)=>N.createElement(Ne,{features:Ve.Hidden,ref:$===0?te=>{var me;ee.current=(me=te==null?void 0:te.closest("form"))!=null?me:null}:void 0,...Ae({key:m,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:i,name:m,value:y})})),G({ourProps:ze,theirProps:h,slot:z,defaultTag:yt,name:"Combobox"}))))}let St="input";function Rt(t,r){var e,o,n,i,l;let u=Q(),{id:d=`headlessui-combobox-input-${u}`,onChange:a,displayValue:p,type:g="text",...v}=t,s=B("Combobox.Input"),h=W("Combobox.Input"),I=Y(s.inputRef,r),O=Be(s.inputRef),b=f.useRef(!1),M=de(),k=x(()=>{h.onChange(null),s.optionsRef.current&&(s.optionsRef.current.scrollTop=0),h.goToOption(E.Nothing)}),F=function(){var c;return typeof p=="function"&&s.value!==void 0?(c=p(s.value))!=null?c:"":typeof s.value=="string"?s.value:""}();ve(([c,z],[w,j])=>{if(b.current)return;let T=s.inputRef.current;T&&((j===0&&z===1||c!==w)&&(T.value=c),requestAnimationFrame(()=>{if(b.current||!T||(O==null?void 0:O.activeElement)!==T)return;let{selectionStart:D,selectionEnd:V}=T;Math.abs((V??0)-(D??0))===0&&D===0&&T.setSelectionRange(T.value.length,T.value.length)}))},[F,s.comboboxState,O]),ve(([c],[z])=>{if(c===0&&z===1){if(b.current)return;let w=s.inputRef.current;if(!w)return;let j=w.value,{selectionStart:T,selectionEnd:D,selectionDirection:V}=w;w.value="",w.value=j,V!==null?w.setSelectionRange(T,D,V):w.setSelectionRange(T,D)}},[s.comboboxState]);let P=f.useRef(!1),K=x(()=>{P.current=!0}),q=x(()=>{M.nextFrame(()=>{P.current=!1})}),U=x(c=>{switch(b.current=!0,c.key){case A.Enter:if(b.current=!1,s.comboboxState!==0||P.current)return;if(c.preventDefault(),c.stopPropagation(),s.activeOptionIndex===null){h.closeCombobox();return}h.selectActiveOption(),s.mode===0&&h.closeCombobox();break;case A.ArrowDown:return b.current=!1,c.preventDefault(),c.stopPropagation(),J(s.comboboxState,{0:()=>h.goToOption(E.Next),1:()=>h.openCombobox()});case A.ArrowUp:return b.current=!1,c.preventDefault(),c.stopPropagation(),J(s.comboboxState,{0:()=>h.goToOption(E.Previous),1:()=>{h.openCombobox(),M.nextFrame(()=>{s.value||h.goToOption(E.Last)})}});case A.Home:if(c.shiftKey)break;return b.current=!1,c.preventDefault(),c.stopPropagation(),h.goToOption(E.First);case A.PageUp:return b.current=!1,c.preventDefault(),c.stopPropagation(),h.goToOption(E.First);case A.End:if(c.shiftKey)break;return b.current=!1,c.preventDefault(),c.stopPropagation(),h.goToOption(E.Last);case A.PageDown:return b.current=!1,c.preventDefault(),c.stopPropagation(),h.goToOption(E.Last);case A.Escape:return b.current=!1,s.comboboxState!==0?void 0:(c.preventDefault(),s.optionsRef.current&&!s.optionsPropsRef.current.static&&c.stopPropagation(),s.nullable&&s.mode===0&&s.value===null&&k(),h.closeCombobox());case A.Tab:if(b.current=!1,s.comboboxState!==0)return;s.mode===0&&s.activationTrigger!==1&&h.selectActiveOption(),h.closeCombobox();break}}),H=x(c=>{a==null||a(c),s.nullable&&s.mode===0&&c.target.value===""&&k(),h.openCombobox()}),R=x(c=>{var z,w,j;let T=(z=c.relatedTarget)!=null?z:be.find(D=>D!==c.currentTarget);if(b.current=!1,!((w=s.optionsRef.current)!=null&&w.contains(T))&&!((j=s.buttonRef.current)!=null&&j.contains(T))&&s.comboboxState===0)return c.preventDefault(),s.mode===0&&(s.nullable&&s.value===null?k():s.activationTrigger!==1&&h.selectActiveOption()),h.closeCombobox()}),S=x(c=>{var z,w,j;let T=(z=c.relatedTarget)!=null?z:be.find(D=>D!==c.currentTarget);(w=s.buttonRef.current)!=null&&w.contains(T)||(j=s.optionsRef.current)!=null&&j.contains(T)||s.disabled||s.immediate&&s.comboboxState!==0&&(h.openCombobox(),M.nextFrame(()=>{h.setActivationTrigger(1)}))}),_=fe(()=>{if(s.labelId)return[s.labelId].join(" ")},[s.labelId]),ie=f.useMemo(()=>({open:s.comboboxState===0,disabled:s.disabled}),[s]),re={ref:I,id:d,role:"combobox",type:g,"aria-controls":(e=s.optionsRef.current)==null?void 0:e.id,"aria-expanded":s.comboboxState===0,"aria-activedescendant":s.activeOptionIndex===null?void 0:s.virtual?(o=s.options.find(c=>{var z;return!((z=s.virtual)!=null&&z.disabled(c.dataRef.current.value))&&s.compare(c.dataRef.current.value,s.virtual.options[s.activeOptionIndex])}))==null?void 0:o.id:(n=s.options[s.activeOptionIndex])==null?void 0:n.id,"aria-labelledby":_,"aria-autocomplete":"list",defaultValue:(l=(i=t.defaultValue)!=null?i:s.defaultValue!==void 0?p==null?void 0:p(s.defaultValue):null)!=null?l:s.defaultValue,disabled:s.disabled,onCompositionStart:K,onCompositionEnd:q,onKeyDown:U,onChange:H,onFocus:S,onBlur:R};return G({ourProps:re,theirProps:v,slot:ie,defaultTag:St,name:"Combobox.Input"})}let Ct="button";function Tt(t,r){var e;let o=B("Combobox.Button"),n=W("Combobox.Button"),i=Y(o.buttonRef,r),l=Q(),{id:u=`headlessui-combobox-button-${l}`,...d}=t,a=de(),p=x(I=>{switch(I.key){case A.ArrowDown:return I.preventDefault(),I.stopPropagation(),o.comboboxState===1&&n.openCombobox(),a.nextFrame(()=>{var O;return(O=o.inputRef.current)==null?void 0:O.focus({preventScroll:!0})});case A.ArrowUp:return I.preventDefault(),I.stopPropagation(),o.comboboxState===1&&(n.openCombobox(),a.nextFrame(()=>{o.value||n.goToOption(E.Last)})),a.nextFrame(()=>{var O;return(O=o.inputRef.current)==null?void 0:O.focus({preventScroll:!0})});case A.Escape:return o.comboboxState!==0?void 0:(I.preventDefault(),o.optionsRef.current&&!o.optionsPropsRef.current.static&&I.stopPropagation(),n.closeCombobox(),a.nextFrame(()=>{var O;return(O=o.inputRef.current)==null?void 0:O.focus({preventScroll:!0})}));default:return}}),g=x(I=>{if(Ke(I.currentTarget))return I.preventDefault();o.comboboxState===0?n.closeCombobox():(I.preventDefault(),n.openCombobox()),a.nextFrame(()=>{var O;return(O=o.inputRef.current)==null?void 0:O.focus({preventScroll:!0})})}),v=fe(()=>{if(o.labelId)return[o.labelId,u].join(" ")},[o.labelId,u]),s=f.useMemo(()=>({open:o.comboboxState===0,disabled:o.disabled,value:o.value}),[o]),h={ref:i,id:u,type:Xe(t,o.buttonRef),tabIndex:-1,"aria-haspopup":"listbox","aria-controls":(e=o.optionsRef.current)==null?void 0:e.id,"aria-expanded":o.comboboxState===0,"aria-labelledby":v,disabled:o.disabled,onClick:g,onKeyDown:p};return G({ourProps:h,theirProps:d,slot:s,defaultTag:Ct,name:"Combobox.Button"})}let Et="label";function wt(t,r){let e=Q(),{id:o=`headlessui-combobox-label-${e}`,...n}=t,i=B("Combobox.Label"),l=W("Combobox.Label"),u=Y(i.labelRef,r);L(()=>l.registerLabel(o),[o]);let d=x(()=>{var p;return(p=i.inputRef.current)==null?void 0:p.focus({preventScroll:!0})}),a=f.useMemo(()=>({open:i.comboboxState===0,disabled:i.disabled}),[i]);return G({ourProps:{ref:u,id:o,onClick:d},theirProps:n,slot:a,defaultTag:Et,name:"Combobox.Label"})}let Mt="ul",kt=xe.RenderStrategy|xe.Static;function zt(t,r){let e=Q(),{id:o=`headlessui-combobox-options-${e}`,hold:n=!1,...i}=t,l=B("Combobox.Options"),u=Y(l.optionsRef,r),d=je(),a=d!==null?(d&ne.Open)===ne.Open:l.comboboxState===0;L(()=>{var s;l.optionsPropsRef.current.static=(s=t.static)!=null?s:!1},[l.optionsPropsRef,t.static]),L(()=>{l.optionsPropsRef.current.hold=n},[l.optionsPropsRef,n]),Je({container:l.optionsRef.current,enabled:l.comboboxState===0,accept(s){return s.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:s.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(s){s.setAttribute("role","none")}});let p=fe(()=>{var s,h;return(h=l.labelId)!=null?h:(s=l.buttonRef.current)==null?void 0:s.id},[l.labelId,l.buttonRef.current]),g=f.useMemo(()=>({open:l.comboboxState===0,option:void 0}),[l]),v={"aria-labelledby":p,role:"listbox","aria-multiselectable":l.mode===1?!0:void 0,id:o,ref:u};return l.virtual&&l.comboboxState===0&&Object.assign(i,{children:N.createElement(xt,null,i.children)}),G({ourProps:v,theirProps:i,slot:g,defaultTag:Mt,features:kt,visible:a,name:"Combobox.Options"})}let Ft="li";function Pt(t,r){var e;let o=Q(),{id:n=`headlessui-combobox-option-${o}`,disabled:i=!1,value:l,order:u=null,...d}=t,a=B("Combobox.Option"),p=W("Combobox.Option"),g=a.virtual?a.activeOptionIndex===a.calculateIndex(l):a.activeOptionIndex===null?!1:((e=a.options[a.activeOptionIndex])==null?void 0:e.id)===n,v=a.isSelected(l),s=f.useRef(null),h=Se({disabled:i,value:l,domRef:s,order:u}),I=f.useContext(we),O=Y(r,s,I?I.measureElement:null),b=x(()=>p.onChange(l));L(()=>p.registerOption(n,h),[h,n]);let M=f.useRef(!(a.virtual||a.__demoMode));L(()=>{if(!a.virtual||!a.__demoMode)return;let R=Oe();return R.requestAnimationFrame(()=>{M.current=!0}),R.dispose},[a.virtual,a.__demoMode]),L(()=>{if(!M.current||a.comboboxState!==0||!g||a.activationTrigger===0)return;let R=Oe();return R.requestAnimationFrame(()=>{var S,_;(_=(S=s.current)==null?void 0:S.scrollIntoView)==null||_.call(S,{block:"nearest"})}),R.dispose},[s,g,a.comboboxState,a.activationTrigger,a.activeOptionIndex]);let k=x(R=>{var S;if(i||(S=a.virtual)!=null&&S.disabled(l))return R.preventDefault();b(),qe()||requestAnimationFrame(()=>{var _;return(_=a.inputRef.current)==null?void 0:_.focus({preventScroll:!0})}),a.mode===0&&requestAnimationFrame(()=>p.closeCombobox())}),F=x(()=>{var R;if(i||(R=a.virtual)!=null&&R.disabled(l))return p.goToOption(E.Nothing);let S=a.calculateIndex(l);p.goToOption(E.Specific,S)}),P=Ze(),K=x(R=>P.update(R)),q=x(R=>{var S;if(!P.wasMoved(R)||i||(S=a.virtual)!=null&&S.disabled(l)||g)return;let _=a.calculateIndex(l);p.goToOption(E.Specific,_,0)}),U=x(R=>{var S;P.wasMoved(R)&&(i||(S=a.virtual)!=null&&S.disabled(l)||g&&(a.optionsPropsRef.current.hold||p.goToOption(E.Nothing)))}),H=f.useMemo(()=>({active:g,selected:v,disabled:i}),[g,v,i]);return G({ourProps:{id:n,ref:O,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":v,disabled:void 0,onClick:k,onFocus:F,onPointerEnter:K,onMouseEnter:K,onPointerMove:q,onMouseMove:q,onPointerLeave:U,onMouseLeave:U},theirProps:d,slot:H,defaultTag:Ft,name:"Combobox.Option"})}let $t=Z(It),_t=Z(Tt),Dt=Z(Rt),At=Z(wt),jt=Z(zt),Lt=Z(Pt),oe=Object.assign($t,{Input:Dt,Button:_t,Label:At,Options:jt,Option:Lt});function Nt(...t){return t.filter(Boolean).join(" ")}const Vt=({searchOn:t="title",sourceData:r,children:e,callback:o})=>{const[n,i]=f.useState(""),[l,u]=f.useState(!1),d=n===""?[]:r.filter(v=>v[t].toString().toLowerCase().includes(n.toLowerCase())),a=e||C.jsx(Ie,{className:"left-4 h-5 w-5 cursor-pointer text-gray-400","aria-hidden":"true"}),p=v=>{if(v){const s=String(v.url);window.location.href=s,u(!1)}};f.useEffect(()=>{function v(s){s.key==="k"&&(s.metaKey||s.ctrlKey)&&u(!l)}return window.addEventListener("keydown",v),()=>{window.removeEventListener("keydown",v)}},[l]),f.useEffect(()=>{o(l)},[l,o]);const g=$e();return C.jsxs(C.Fragment,{children:[C.jsx("button",{onClick:()=>u(!0),"aria-label":"search",className:"not-prose",children:a}),C.jsx(ae.Root,{show:l,as:f.Fragment,afterLeave:()=>i(""),appear:!0,children:C.jsxs(ge,{as:"div",className:"cu-search not-prose relative z-50",onClose:u,children:[C.jsx(ae.Child,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:C.jsx("div",{className:`fixed inset-0 transition-opacity ${Pe} `})}),C.jsx("div",{className:"z-100 fixed inset-0 overflow-y-auto p-4 sm:p-6 md:p-20",children:C.jsx(ae.Child,{as:f.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:C.jsx(ge.Panel,{className:"mx-auto mt-[20vh] max-w-xl transform divide-y divide-gray-100 overflow-hidden rounded-xl bg-white shadow-2xl ring-1 ring-black ring-opacity-5 transition-all",children:C.jsxs(oe,{onChange:p,children:[C.jsxs("div",{className:"relative",children:[C.jsx(Ie,{className:"pointer-events-none absolute left-4 top-3.5 h-5 w-5 text-gray-400","aria-hidden":"true"}),C.jsx(oe.Input,{className:"h-12 w-full rounded-lg border border-cu-black-100 bg-transparent pl-11 pr-4 text-sm text-cu-black-800 placeholder-cu-black-300 focus:border-cu-black-300 focus:ring-0",placeholder:"Search...",onChange:v=>i(v.target.value)}),n&&C.jsx(We,{className:"absolute right-4 top-3.5 h-4 w-4 text-gray-400","aria-hidden":"true",onClick:()=>{i("")}})]}),d.length>0&&C.jsx(oe.Options,{static:!0,className:"max-h-72 scroll-py-2 overflow-y-auto py-2 text-sm text-gray-800",children:d.map(v=>C.jsx(oe.Option,{value:v,className:({active:s})=>Nt("cursor-default select-none px-4 py-2",s&&"bg-cu-red text-white"),children:C.jsx(g,{href:`${v.url}`,onClick:()=>u(!1),children:v[t]})},v.id))}),n!==""&&d.length===0&&C.jsx("p",{className:"p-4 text-sm text-gray-500",children:"Search not found"})]})})})})]})})]})};Vt.__docgenInfo={description:"",methods:[],displayName:"Search",props:{sourceData:{required:!0,tsType:{name:"Array",elements:[{name:"SourceDataProps"}],raw:"SourceDataProps[]"},description:""},searchOn:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:"'title'",computed:!1}},callback:{required:!0,tsType:{name:"signature",type:"function",raw:"(k: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"k"}],return:{name:"void"}}},description:""}}};export{Vt as S,We as X};
