var p=Object.defineProperty;var g=(o,i,e)=>i in o?p(o,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[i]=e;var c=(o,i,e)=>g(o,typeof i!="symbol"?i+"":i,e);import{j as s}from"./jsx-runtime-Cf8x2fCZ.js";import{e as v,r as b}from"./index-DDmFEvuO.js";class y{constructor(i){c(this,"parentElement");c(this,"dropdowns");this.parentElement=i,this.dropdowns=this.parentElement.querySelectorAll(".cu-filter__dropdown"),this.dropdownsClick()}dropdownsClick(){this.dropdowns&&this.dropdowns.forEach(i=>{this.dropdownsClickHandler(i)})}dropdownsClickHandler(i){const e=i.querySelector(".cu-filter__dropdown-toggle"),t=i.querySelector(".cu-filter__dropdown-arrow"),r=i.querySelector(".cu-filter__dropdown-menu");e&&r&&(e.addEventListener("click",l=>{l.stopPropagation();const a=r.classList.contains("hidden");if(!a){this.closeAllDropdowns();return}this.closeAllDropdowns(),r.classList.toggle("hidden",!a),a?this.alignDropdowns(r):(r.style.left="",r.style.right=""),t&&t.classList.toggle("rotate-180",a);const n=e.attributes.getNamedItem("aria-expanded");n&&(n.value=a.toString());const f=e.attributes.getNamedItem("aria-haspopup");f&&(f.value=a.toString())}),document.addEventListener("click",l=>{i.contains(l.target)||(r.classList.add("hidden"),t&&t.classList.remove("rotate-180"))}),r.addEventListener("click",l=>{l.stopPropagation()}))}alignDropdowns(i){const{right:e,left:t}=i.getBoundingClientRect(),r=this.parentElement.offsetWidth;e>r&&Object.assign(i.style,{right:"-16px",left:"auto"}),t<0&&Object.assign(i.style,{left:"-16px",right:"auto"})}closeAllDropdowns(){this.dropdowns.forEach(i=>{const e=i.querySelector(".cu-filter__dropdown-menu"),t=i.querySelector(".cu-filter__dropdown-arrow");e&&e.classList.add("hidden"),t&&t.classList.remove("rotate-180")})}destroy(){console.log("Destroying dropdowns"),this.closeAllDropdowns()}}class x extends y{constructor(e){super(e);c(this,"filter");c(this,"sortingItems");c(this,"filteringItems");c(this,"activeFilterPanel");c(this,"activeFilterRemoveBtns");c(this,"dropdownItems");c(this,"_activeFilterItems",{sortBy:"",filterBy:{}});this.filter=e,this.sortingItems=this.filter.querySelectorAll(".cu-filter__sorting-item"),this.filteringItems=this.filter.querySelectorAll(".cu-filter__filtering-item"),this.activeFilterPanel=this.filter.querySelector(".cu-filter__active-filter-panel"),this.activeFilterRemoveBtns=this.filter.querySelectorAll(".cu-filter__active-filter-remove"),this.dropdownItems=this.filter.querySelectorAll(".cu-filter__dropdown-toggle"),this.init()}init(){this.activeSortItemLoad(),this.sortItemClick(),this.setActiveFilterItems(),this.activeFilterItemLoad(),this.filterItemClick(),this.activeFilterRemoveBtnsClick()}emitActiveFilterChange(){if(!this.filter){console.error("Filter element is not defined.");return}const e=new CustomEvent("filterChange",{detail:this._activeFilterItems});this.filter.dispatchEvent(e)}setActiveFilterItems(){this.dropdownItems&&this.dropdownItems.forEach(e=>{const t=e.getAttribute("data-filter-type");t&&(this._activeFilterItems.filterBy[t]=[])})}activeFilterItemLoad(){this.filteringItems&&this.filteringItems.forEach(e=>{this.filterItemClickHandler(e)})}activeSortItemLoad(){this.sortingItems&&this.sortingItems.forEach(e=>{e.getAttribute("data-selected")==="true"&&(this._activeFilterItems.sortBy=e.getAttribute("data-sort")||"")})}sortItemClick(){this.sortingItems&&this.sortingItems.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const r=t.currentTarget;this.sortItemClickHandler(r)})})}filterItemClick(){this.filteringItems&&this.filteringItems.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const r=t.target;this.filterItemClickHandler(r),this.emitActiveFilterChange()})})}activeFilterRemoveBtnsClick(){this.activeFilterRemoveBtns&&this.activeFilterRemoveBtns.forEach(e=>{e.addEventListener("click",t=>{t.stopPropagation();const r=t.currentTarget,l=r.getAttribute("data-label");if(!l)return;const a=r.getAttribute("data-filter-type");a&&this._activeFilterItems.filterBy[a]&&(this._activeFilterItems.filterBy[a]=this._activeFilterItems.filterBy[a].filter(n=>n!==l)),this.unselectFilterItem(l),this.removeFromActiveFilterPanel(l),super.closeAllDropdowns(),this.emitActiveFilterChange()})})}sortItemClickHandler(e){this.unselectSortItem();const t=e.getAttribute("data-sort");e.setAttribute("data-selected","true"),e.classList.add("bg-gray-100"),this._activeFilterItems.sortBy=t||"",this.closeAllDropdowns()}unselectSortItem(){this.sortingItems&&this.sortingItems.forEach(e=>{e&&(e.setAttribute("data-selected","false"),e.classList.remove("bg-gray-100"))})}filterItemClickHandler(e){var a;const t=e.getAttribute("data-label"),r=e.getAttribute("value"),l=e.getAttribute("data-filter-type");if(t&&r&&l)if(e.checked)this._activeFilterItems.filterBy[l].push(r),this.addToActiveFilterPanel(t,r,l);else{const n=(a=this._activeFilterItems.filterBy[l])==null?void 0:a.indexOf(r);n!==void 0&&n>-1&&this._activeFilterItems.filterBy[l].splice(n,1),this.removeFromActiveFilterPanel(r)}}addToActiveFilterPanel(e,t,r){if(!this.activeFilterPanel||!e||!r||!t)return;const l=`<div class="flex items-center gap-0.5 pl-3 pe-2 py-1 border rounded-lg border-cu-black-100">
            <span>${e}</span>
            <button
              type="button"
              class="cu-filter__active-filter-remove flex flex-shrink-0 w-4 h-4 p-1 ml-1 rounded-full text-cu-black-400 hover:bg-cu-red hover:text-white"
              data-label="${t}"
              data-filter-type="${r}"
            >
              <span class="sr-only">Remove filter for ${e}</span>
              <svg class="w-2 h-2" stroke="currentColor" fill="none" viewBox="0 0 8 8">
                <path strokeLinecap="round" strokeWidth="1.5" d="M1 1l6 6m0-6L1 7"></path>
              </svg>
            </button>
          </div>`;this.activeFilterPanel.insertAdjacentHTML("beforeend",l),this.activeFilterRemoveBtns=this.filter.querySelectorAll(".cu-filter__active-filter-remove"),this.activeFilterRemoveBtnsClick()}removeFromActiveFilterPanel(e){var r;if(!this.activeFilterPanel||!e)return;const t=this.activeFilterPanel.querySelector(`[data-label="${e}"]`);if(t){(r=t.parentElement)==null||r.remove();const l=t.getAttribute("data-label");if(!l)return;this.unselectFilterItem(l)}}get activeFilterItems(){return this._activeFilterItems}unselectFilterItem(e){e&&this.filteringItems.forEach(t=>{t&&t.value===e&&(t.checked=!1)})}unselectAllFilterMenuItems(){this.filteringItems&&(this.filteringItems.forEach(e=>{const t=e.querySelector('input[type="checkbox"]');if(t){const r=t.getAttribute("data-label");t.checked=!1,r&&this.removeFromActiveFilterPanel(r)}}),this._activeFilterItems.filterBy={},this._activeFilterItems.sortBy="")}destroy(){this.unselectAllFilterMenuItems()}}const w=()=>{const o=document.querySelectorAll(".cu-filter");if(!o)return;const i=[];return o.forEach(e=>{const t=new x(e);i.push(t)}),{destroy:()=>{i.forEach(e=>e.destroy())}}},d=()=>s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",className:"cu-filter__dropdown-arrow flex-shrink-0 w-5 h-5 ml-1 text-cu-black-300 group-hover:text-cu-black-600 ease-in-out duration-300",children:s.jsx("path",{fillRule:"evenodd",d:"M5.22 8.22a.75.75 0 0 1 1.06 0L10 11.94l3.72-3.72a.75.75 0 1 1 1.06 1.06l-4.25 4.25a.75.75 0 0 1-1.06 0L5.22 9.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"})}),u=({sortOptions:o,filterOptions:i})=>{const e="cu-filter__dropdown relative",t="cu-filter__dropdown-toggle inline-flex justify-center text-sm font-medium text-cu-black-800 group hover:text-cu-red";return s.jsx("div",{className:"border rounded-tl-lg rounded-tr-lg border-cu-black-100 bg-gray-50 px-4 py-4 sm:px-6",children:s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[o&&s.jsxs("div",{className:e,children:[s.jsxs("button",{className:t,type:"button",id:"sortMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false",children:["Sort",s.jsx(d,{})]}),s.jsx("ul",{className:"cu-filter__dropdown-menu hidden not-prose list-none absolute z-10 left-0 mt-2 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none w-32 sm:w-60","aria-labelledby":"sortMenuButton",children:o.map((r,l)=>s.jsx("li",{className:"!my-0",children:s.jsx("button",{type:"button","data-selected":r.selected,"data-sort":r.value,className:`cu-filter__sorting-item text-cu-black-600 block px-4 py-2 hover:bg-gray-200 w-full text-start ${r.selected?"bg-gray-100":""}`,children:r.label})},l))})]}),i&&s.jsx("div",{className:"ms-auto",children:s.jsx("div",{className:"flex flex-wrap items-center gap-3 sm:gap-4",children:i.map((r,l)=>s.jsxs(v.Fragment,{children:[s.jsxs("div",{className:e,children:[s.jsxs("button",{className:t,type:"button",id:`${r.id}MenuButton`,"data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false","data-filter-type":r.id,children:[r.name,s.jsx(d,{})]}),s.jsx("ul",{className:"cu-filter__dropdown-menu hidden not-prose list-none absolute z-10 left-0 mt-2 bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none p-3 sm:p-4 w-32 sm:w-60","aria-labelledby":`${r.id}MenuButton`,children:r.options.map((a,n)=>s.jsxs("li",{className:`flex items-center ${n!==r.options.length-1?"mb-4":""}`,children:[s.jsx("input",{id:`filter-${a.value}`,name:`${r.id}[]`,type:"checkbox",defaultChecked:a.checked,className:"cu-filter__filtering-item w-4 h-4 rounded border-cu-black-200 text-cu-red focus:ring-cu-red-100",value:a.value,"data-label":a.label,"data-filter-type":r.id}),s.jsx("label",{htmlFor:`filter-${a.value}`,className:"pr-6 ml-3 text-sm text-cu-black-600",children:a.label})]},n))})]}),l<i.length-1&&s.jsx("span",{className:"border-l border-cu-black-100 h-8 w-[1px]"})]},l))})})]})})};u.displayName="FilterPanel.Top";d.__docgenInfo={description:"",methods:[],displayName:"DropDownSVG"};u.__docgenInfo={description:"",methods:[],displayName:"FilterPanel.Top",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},sortOptions:{required:!1,tsType:{name:"Array",elements:[{name:"SortOptions"}],raw:"SortOptions[]"},description:""},filterOptions:{required:!1,tsType:{name:"Array",elements:[{name:"FilterOptions"}],raw:"FilterOptions[]"},description:""}}};const m=()=>s.jsxs("div",{className:"bg-white flex items-start text-sm text-cu-black-600 border border-t-0 rounded-bl-lg rounded-br-lg border-cu-black-100 px-4 py-4 sm:px-6 sm:py-5 gap-x-4 sm:gap-x-5 gap-y-3",children:[s.jsxs("div",{className:"flex items-center gap-x-4 sm:gap-x-5 gap-y-3",children:[s.jsx("span",{children:"Filters"}),s.jsx("span",{className:"border-l border-cu-black-100 h-7 w-[1px]"})]}),s.jsx("div",{className:"cu-filter__active-filter-panel flex flex-wrap items-center gap-3"})]});m.displayName="FilterPanel.Bottom";m.__docgenInfo={description:"",methods:[],displayName:"FilterPanel.Bottom"};const h=({children:o})=>(b.useEffect(()=>{const i=w();return()=>{i&&typeof i.destroy=="function"&&i.destroy()}},[]),s.jsx("div",{className:"cu-filter text-sm font-medium",children:o})),k=Object.assign(h,{Top:u,Bottom:m});h.__docgenInfo={description:"",methods:[],displayName:"FilterPanelWrapper",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};export{k as F};
